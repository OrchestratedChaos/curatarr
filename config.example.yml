# Plex Recommendation System - Configuration
# Single consolidated config for both Movies and TV Shows

# Plex Server Connection
plex:
  url: http://YOUR_PLEX_URL:32400  # Or https://YOUR-SERVER.plex.direct:32400
  token: YOUR_PLEX_TOKEN  # Get from: https://support.plex.tv/articles/204059436
  movie_library: Movies
  tv_library: TV Shows
  verify_ssl: false  # Set to true if you want SSL certificate verification

# TMDB API
tmdb:
  api_key: YOUR_TMDB_API_KEY  # Get free key from: https://www.themoviedb.org/settings/api

# Users and Preferences
users:
  list: user1, user2, user3  # Your Plex usernames (comma-separated)
  preferences:
    user1:
      display_name: User One
      exclude_genres:
        - horror  # Optional: genres to exclude from recommendations
      streaming_services:  # Optional: your streaming subscriptions (US region)
        - netflix
        - hulu
        - disney_plus
        - amazon_prime
    user2:
      display_name: User Two
      streaming_services:
        - netflix
    user3:
      display_name: User Three

# General Settings
general:
  confirm_operations: false
  plex_only: true
  log_retention_days: 7  # Keep logs for 7 days (0 = keep all)
  auto_update: true  # Automatically update from GitHub on run

# Logging (optional)
logging:
  level: INFO  # DEBUG, INFO, WARNING, ERROR (--debug flag overrides to DEBUG)

# Movies Settings
movies:
  limit_results: 50
  randomize_recommendations: false
  show_summary: true
  show_cast: true
  show_director: true
  show_genres: true
  show_language: true
  show_rating: true
  show_imdb_link: true
  quality_filters:
    min_rating: 5.0
    min_vote_count: 15
  weights:
    genre: 0.25
    director: 0.05
    actor: 0.20
    keyword: 0.50
  radarr:
    enabled: false
    url: http://localhost:7878
    api_key: null
    root_folder: /path/to/movies
    quality_profile: HD-1080p
    tag: RecommendForPlex
    monitor: false
    search_for_movie: false
    append_usernames: false

# TV Shows Settings
tv:
  limit_results: 20
  randomize_recommendations: false
  normalize_counters: true
  show_summary: true
  show_cast: true
  show_language: true
  show_rating: true
  show_imdb_link: true
  quality_filters:
    min_rating: 0.0
    min_vote_count: 0
  weights:
    genre: 0.25
    studio: 0.10
    actor: 0.20
    keyword: 0.45
  sonarr:
    enabled: false
    url: http://localhost:8989
    api_key: null
    root_folder: /path/to/tv
    quality_profile: HD-1080p
    tag: RecommendForPlex
    season_folder: true
    monitor: false
    monitor_option: none
    search_missing: false
    append_usernames: false

# Collection Settings
collections:
  add_label: true
  label_name: Recommended
  append_usernames: true
  remove_previous_recommendations: false  # Changed: use stale removal instead
  stale_removal_days: 7  # Remove unwatched recs after 7 days (configurable)

# Recency Decay (shared)
recency_decay:
  enabled: true
  days_0_30: 1.0
  days_31_90: 0.75
  days_91_180: 0.50
  days_181_365: 0.25
  days_365_plus: 0.10

# Rating Multipliers - how much user ratings influence profile weighting
# Higher values = ratings matter more. 5-star content dominates profile.
rating_multipliers:
  star_5: 2.5    # 5 stars (outstanding) - strong signal
  star_4: 1.7    # 4 stars (very good)
  star_3: 1.0    # 3 stars (neutral baseline)
  star_2: 0.4    # 2 stars (poor)
  star_1: 0.2    # 1 star (very poor)

# Negative Signals - penalize content similar to disliked items
# When enabled, low ratings and dropped shows create anti-preferences
negative_signals:
  enabled: true                    # Master switch for all negative signals
  bad_ratings:
    enabled: true                  # Use low ratings (1-3 stars) as penalties
    threshold: 3                   # Plex ratings 0-3 become negative (0-10 scale, so 3 = 1.5 stars)
    cap_penalty: 0.5               # Limit: negative can only reduce positive counter to this fraction
  dropped_shows:
    enabled: true                  # Detect abandoned TV shows as negative signals
    min_episodes_watched: 2        # Must watch at least N episodes to count as "dropped"
    max_completion_percent: 25     # Consider dropped if watched < 25% of show
    penalty_multiplier: -0.4       # Weight applied to dropped show attributes

# External Recommendations (watchlist of content NOT in library)
external_recommendations:
  enabled: true  # Generate external watchlists
  movie_limit: 30  # Number of movie recommendations per user
  show_limit: 20  # Number of TV show recommendations per user
  min_relevance_score: 0.25  # Minimum personal relevance score (0.0-1.0). Items below this
                              # threshold are only included if not enough high-relevance items exist.
                              # 0.25 = 25% relevance minimum. Higher = stricter, fewer results.
  auto_open_html: false  # Automatically open HTML watchlist in browser after generation

# Trakt Integration (optional)
# Sync recommendations to Trakt lists and pull watch history
#
# WARNING: Trakt export syncs data to YOUR personal Trakt account.
# Make sure you understand which Plex users' data will be exported.
# The default is OFF - you must explicitly enable and configure it.
trakt:
  enabled: false  # Set to true to enable Trakt integration
  client_id: null  # Get from: https://trakt.tv/oauth/applications
  client_secret: null
  # Tokens are set automatically after OAuth authentication
  access_token: null
  refresh_token: null

  # Export settings - push recommendations to Trakt lists
  # Disabled by default. You must:
  #   1. Set auto_sync: true
  #   2. Configure plex_users with YOUR Plex username(s)
  export:
    enabled: true  # Allow export feature (still requires auto_sync or HTML button)
    auto_sync: false  # OFF by default. Set to true to auto-export on each run.
                      # When false, you can still export manually via HTML button.
    list_prefix: "Curatarr"  # Lists named: "Curatarr - Username - Movies"
    privacy: "private"  # private, friends, or public

    # Which Plex users to export to YOUR Trakt account:
    #   mapping  - Only users listed in plex_users below (RECOMMENDED)
    #   per_user - Separate Trakt list for each Plex user (exports ALL users)
    #   combined - All users merged into one Trakt list (exports ALL users)
    #
    # IMPORTANT: "per_user" and "combined" export ALL Plex users' data to your Trakt.
    # Most admins should use "mapping" and only list their own username below.
    user_mode: "mapping"

    # Plex usernames to export (required when user_mode is "mapping")
    # This should be YOUR Plex username - not your family/household members.
    # Example: If your Plex username is "jason", set: plex_users: ["jason"]
    plex_users: []  # Empty by default - you must add your username to enable export

  # Import settings - pull data from Trakt to enhance recommendations
  import:
    enabled: true  # Import Trakt data to enhance recommendations
    merge_watch_history: true  # Merge Trakt watch history into profile (streaming services)
    exclude_watchlist: true  # Exclude items on your Trakt watchlist from recommendations

# Platform Settings
platform:
  type: darwin
  path_mappings: null
